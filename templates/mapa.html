<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8"/>
    <title>Geovisor de Avalúos</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
    <style>
      #map { height: 90vh; width: 100%; }
      body { background: #fafafa; margin:0; padding:0; font-family: Roboto,sans-serif;}
      h3 { text-align:center; margin: 2rem 0 1rem; color:#1565c0;}
    </style>
</head>
<body>
    <h3>Mapa de Avalúos</h3>
    <div id="map"></div>
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script>
      var map = L.map('map').setView([4.65, -74.1], 12);
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
          maxZoom: 19,
      }).addTo(map);

      fetch("/api/avaluos")
        .then(res => res.json())
        .then(data => {
            data.forEach(pt => {
                L.marker([pt.lat, pt.lon])
                  .addTo(map)
                  .bindPopup("<b>Consecutivo:</b> " + pt.consecutivo + "<br><b>Dirección:</b> " + (pt.direccion || ""));
            });
        });
    </script>
</body>
</html>
